<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‰∫§Â∑ÆÁÇπÈÉ® - ‰∫§ÊµÅ‰ºöÂèÇÂä†ËÄÖ„Å§„Å™„Åå„Çä„ÉÑ„Éº„É´</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
            margin: 0;
            padding: 0;
        }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Simple storage
        const storage = {
            get(key) {
                try {
                    const item = localStorage.getItem(`kosasenbu_${key}`);
                    return item ? JSON.parse(item) : null;
                } catch {
                    return null;
                }
            },
            set(key, value) {
                try {
                    localStorage.setItem(`kosasenbu_${key}`, JSON.stringify(value));
                    return true;
                } catch {
                    return false;
                }
            },
            remove(key) {
                try {
                    localStorage.removeItem(`kosasenbu_${key}`);
                    return true;
                } catch {
                    return false;
                }
            }
        };

        function App() {
            const [currentUser, setCurrentUser] = useState(null);
            const [users, setUsers] = useState([]);
            const [loading, setLoading] = useState(true);

            useEffect(() => {
                loadData();
            }, []);

            const loadData = () => {
                try {
                    let savedUsers = storage.get('users') || [];
                    
                    if (savedUsers.length === 0) {
                        const adminUser = {
                            id: 'admin-1',
                            email: 'assi14iii@gmail.com',
                            password: 'kouassi93',
                            isAdmin: true,
                            qrCode: 'KOSASENBU-ADMIN-001',
                            profile: {
                                nickname: '',
                                fullName: '',
                                photo: null,
                                email: '',
                                phoneNumber: '',
                                lineAccount: '',
                                instagram: '',
                                threads: '',
                                facebook: '',
                                twitter: '',
                                linkedin: '',
                                company: '',
                                businessCardFront: null,
                                businessCardBack: null,
                                introduction: '',
                                privacySetting: 'public'
                            }
                        };
                        savedUsers = [adminUser];
                        storage.set('users', savedUsers);
                    }
                    
                    setUsers(savedUsers);
                    
                    const savedUser = storage.get('currentUser');
                    if (!savedUser) {
                        const admin = savedUsers.find(u => u.email === 'assi14iii@gmail.com');
                        if (admin) {
                            storage.set('currentUser', admin);
                            setCurrentUser(admin);
                        }
                    } else {
                        setCurrentUser(savedUser);
                    }

                    // Add test event if none exists or if test event doesn't have attendances
                    let savedEvents = storage.get('events') || [];
                    const testEventExists = savedEvents.find(e => e.id === 'event-test-1' && e.attendances && e.attendances.includes('admin-1'));
                    
                    if (!testEventExists) {
                        // Remove old test event if it exists without attendances
                        savedEvents = savedEvents.filter(e => e.id !== 'event-test-1');
                        
                        const testEvent = {
                            id: 'event-test-1',
                            title: '„Å™„Çì„Å§„Å™Ôº†„Ç´„É™„Ç≥„Ç≥',
                            date: '2026-01-15T19:00',
                            endDate: '2026-01-15T22:00',
                            address: 'ÊÑõÁü•ÁúåË±äÂ∑ùÂ∏Ç',
                            venueName: '„Ç´„É™„Ç≥„Ç≥',
                            fee: '500ÂÜÜ',
                            registrations: [],
                            attendances: ['admin-1'] // Admin attended
                        };
                        savedEvents.push(testEvent);
                        storage.set('events', savedEvents);
                    }
                } catch (e) {
                    console.error('Load error:', e);
                }
                setLoading(false);
            };

            const login = (email, password) => {
                const user = users.find(u => u.email === email && u.password === password);
                if (!user) {
                    alert('„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„Åæ„Åü„ÅØ„Éë„Çπ„ÉØ„Éº„Éâ„ÅåÊ≠£„Åó„Åè„ÅÇ„Çä„Åæ„Åõ„Çì');
                    return false;
                }
                storage.set('currentUser', user);
                setCurrentUser(user);
                return true;
            };

            const register = (email, password) => {
                if (users.find(u => u.email === email)) {
                    alert('„Åì„ÅÆ„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„ÅØÊó¢„Å´ÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åô');
                    return false;
                }

                const newUser = {
                    id: Date.now().toString(),
                    email,
                    password,
                    isAdmin: email === 'assi14iii@gmail.com',
                    qrCode: `KOSASENBU-${Date.now()}`,
                    profile: {
                        nickname: '',
                        fullName: '',
                        photo: null,
                        email: '',
                        phoneNumber: '',
                        lineAccount: '',
                        instagram: '',
                        threads: '',
                        facebook: '',
                        twitter: '',
                        linkedin: '',
                        company: '',
                        businessCardFront: null,
                        businessCardBack: null,
                        introduction: '',
                        privacySetting: 'public'
                    }
                };

                const updatedUsers = [...users, newUser];
                storage.set('users', updatedUsers);
                setUsers(updatedUsers);
                return true;
            };

            const logout = () => {
                storage.remove('currentUser');
                setCurrentUser(null);
            };

            const updateProfile = (updatedProfile) => {
                const updatedUsers = users.map(u => 
                    u.id === currentUser.id ? { ...u, profile: updatedProfile } : u
                );
                storage.set('users', updatedUsers);
                setUsers(updatedUsers);
                
                const updatedUser = { ...currentUser, profile: updatedProfile };
                storage.set('currentUser', updatedUser);
                setCurrentUser(updatedUser);
            };

            if (loading) {
                return <div className="flex items-center justify-center min-h-screen">
                    <div className="text-xl">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
                </div>;
            }

            if (!currentUser) {
                return <AuthScreen onLogin={login} onRegister={register} />;
            }

            return <UserDashboard 
                currentUser={currentUser}
                users={users}
                onLogout={logout}
                onUpdateProfile={updateProfile}
            />;
        }

        function AuthScreen({ onLogin, onRegister }) {
            const [view, setView] = useState('login');
            const [email, setEmail] = useState('');
            const [emailConfirm, setEmailConfirm] = useState('');
            const [password, setPassword] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                if (view === 'login') {
                    onLogin(email, password);
                } else {
                    if (email !== emailConfirm) {
                        alert('„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„Åå‰∏ÄËá¥„Åó„Åæ„Åõ„Çì');
                        return;
                    }
                    if (onRegister(email, password)) {
                        alert('ÁôªÈå≤ÂÆå‰∫Ü„Åó„Åæ„Åó„Åü');
                        setView('login');
                        setEmail('');
                        setEmailConfirm('');
                        setPassword('');
                    }
                }
            };

            return (
                <div className="gradient-bg min-h-screen flex items-center justify-center p-4">
                    <div className="bg-white rounded-lg shadow-2xl p-8 max-w-md w-full">
                        <h1 className="text-3xl font-bold text-center mb-2">‰∫§Â∑ÆÁÇπÈÉ®</h1>
                        <p className="text-center text-gray-600 mb-6">„Äú‰∫∫„Å®Ê¥ªÂãï„Åå„Å§„Å™„Åå„ÇãÂ†¥ÊâÄ„Äú</p>
                        
                        <form onSubmit={handleSubmit} className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium mb-1">„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ</label>
                                <input
                                    type="email"
                                    value={email}
                                    onChange={(e) => setEmail(e.target.value)}
                                    className="w-full px-4 py-2 border rounded-lg"
                                    required
                                />
                            </div>

                            {view === 'register' && (
                                <div>
                                    <label className="block text-sm font-medium mb-1">„É°„Éº„É´„Ç¢„Éâ„É¨„ÇπÔºàÁ¢∫Ë™çÁî®Ôºâ</label>
                                    <input
                                        type="email"
                                        value={emailConfirm}
                                        onChange={(e) => setEmailConfirm(e.target.value)}
                                        className="w-full px-4 py-2 border rounded-lg"
                                        required
                                    />
                                    {emailConfirm && email !== emailConfirm && (
                                        <p className="text-red-600 text-sm mt-1">„É°„Éº„É´„Ç¢„Éâ„É¨„Çπ„Åå‰∏ÄËá¥„Åó„Åæ„Åõ„Çì</p>
                                    )}
                                </div>
                            )}
                            
                            <div>
                                <label className="block text-sm font-medium mb-1">„Éë„Çπ„ÉØ„Éº„Éâ</label>
                                <input
                                    type="password"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    className="w-full px-4 py-2 border rounded-lg"
                                    required
                                />
                            </div>
                            
                            <button
                                type="submit"
                                className="w-full bg-purple-600 text-white py-2 rounded-lg hover:bg-purple-700"
                            >
                                {view === 'login' ? '„É≠„Ç∞„Ç§„É≥' : 'Êñ∞Ë¶èÁôªÈå≤'}
                            </button>
                        </form>
                        
                        <div className="mt-4 text-center">
                            <button
                                onClick={() => setView(view === 'login' ? 'register' : 'login')}
                                className="text-purple-600 text-sm"
                            >
                                {view === 'login' ? '„Ç¢„Ç´„Ç¶„É≥„ÉàÊñ∞Ë¶èÁôªÈå≤' : '„É≠„Ç∞„Ç§„É≥„Å´Êàª„Çã'}
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        function UserDashboard({ currentUser, users, onLogout, onUpdateProfile }) {
            const [view, setView] = useState('home');
            const [myPageView, setMyPageView] = useState('overview');
            const [showQR, setShowQR] = useState(false);
            const [showAdmin, setShowAdmin] = useState(false);
            const [profileData, setProfileData] = useState(currentUser.profile);
            const [isEditingProfile, setIsEditingProfile] = useState(false);
            const [viewingAttendees, setViewingAttendees] = useState(null);
            const [selectedAttendees, setSelectedAttendees] = useState([]);
            const [selectedProfile, setSelectedProfile] = useState(null);
            const [expandedEventId, setExpandedEventId] = useState(null);
            const [events, setEvents] = useState([]);
            const [selectedEvent, setSelectedEvent] = useState(null);
            const [showRegistrationConfirm, setShowRegistrationConfirm] = useState(false);
            const [showCancelConfirm, setShowCancelConfirm] = useState(false);
            const [eventToCancel, setEventToCancel] = useState(null);

            const loadEvents = () => {
                const savedEvents = storage.get('events') || [];
                setEvents(savedEvents);
            };

            useEffect(() => {
                loadEvents();
                const interval = setInterval(() => {
                    if (view === 'home') {
                        loadEvents();
                    }
                }, 2000);
                return () => clearInterval(interval);
            }, [view]);

            const upcomingEvents = events
                .filter(event => new Date(event.date) >= new Date())
                .sort((a, b) => new Date(a.date) - new Date(b.date));

            const myRegisteredEvents = events.filter(event => 
                event.registrations && event.registrations.includes(currentUser.id)
            );

            const myAttendedEvents = events.filter(event =>
                event.attendances && event.attendances.includes(currentUser.id)
            );

            const myOngoingEvents = events.filter(event => {
                const eventDate = new Date(event.date);
                const eventEndDate = event.endDate ? new Date(event.endDate) : null;
                const now = new Date();
                
                if (eventEndDate) {
                    return eventDate <= now && now <= eventEndDate && event.attendances && event.attendances.includes(currentUser.id);
                } else {
                    const eventEnd = new Date(eventDate.getTime() + 6 * 60 * 60 * 1000); // Default 6 hours
                    return eventDate <= now && now <= eventEnd && event.attendances && event.attendances.includes(currentUser.id);
                }
            });

            const getName = (user) => {
                return user.profile.fullName || user.profile.nickname || user.email;
            };

            const formatDateTime = (dateString) => {
                const date = new Date(dateString);
                return date.toLocaleString('ja-JP', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            };

            const handleImageUpload = (e, field) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        setProfileData({ ...profileData, [field]: event.target.result });
                    };
                    reader.readAsDataURL(file);
                }
            };

            const saveProfile = (e) => {
                e.preventDefault();
                
                // Validate: either nickname or fullName must be filled
                if (!profileData.nickname && !profileData.fullName) {
                    alert('„Éã„ÉÉ„ÇØ„Éç„Éº„É†„Åæ„Åü„ÅØÊ∞èÂêç„ÅÆ„Å©„Å°„Çâ„Åã‰∏ÄÊñπ„ÅØÂÖ•ÂäõÂøÖÈ†à„Åß„Åô');
                    return;
                }
                
                onUpdateProfile(profileData);
                alert('„Éó„É≠„Éï„Ç£„Éº„É´„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü');
            };

            const registerForEvent = () => {
                if (!selectedEvent) return;

                const updatedEvents = events.map(event => {
                    if (event.id === selectedEvent.id) {
                        const registrations = event.registrations || [];
                        if (!registrations.includes(currentUser.id)) {
                            return { ...event, registrations: [...registrations, currentUser.id] };
                        }
                    }
                    return event;
                });

                storage.set('events', updatedEvents);
                setEvents(updatedEvents);
                setShowRegistrationConfirm(false);
                setSelectedEvent(null);
                alert('ÂèÇÂä†‰∫àÂÆö„Å´ÁôªÈå≤„Åó„Åæ„Åó„Åü');
            };

            const cancelEventRegistration = () => {
                if (!eventToCancel) return;

                const updatedEvents = events.map(event => {
                    if (event.id === eventToCancel.id) {
                        const registrations = event.registrations || [];
                        return { 
                            ...event, 
                            registrations: registrations.filter(id => id !== currentUser.id) 
                        };
                    }
                    return event;
                });

                storage.set('events', updatedEvents);
                setEvents(updatedEvents);
                setShowCancelConfirm(false);
                setEventToCancel(null);
                alert('ÂèÇÂä†„Çí„Ç≠„É£„É≥„Çª„É´„Åó„Åæ„Åó„Åü');
            };

            const isRegistered = (eventId) => {
                const event = events.find(e => e.id === eventId);
                return event && event.registrations && event.registrations.includes(currentUser.id);
            };

            if (showAdmin && currentUser.isAdmin) {
                return <AdminPanel users={users} onBack={() => {
                    setShowAdmin(false);
                    loadEvents();
                }} onLogout={onLogout} />;
            }

            return (
                <div className="min-h-screen bg-gray-50">
                    <header className="gradient-bg text-white p-4">
                        <div className="flex justify-between items-center">
                            <h1 className="text-xl font-bold">‰∫§Â∑ÆÁÇπÈÉ®</h1>
                            <button onClick={onLogout} className="bg-white text-purple-600 px-3 py-2 rounded-lg text-sm">
                                „É≠„Ç∞„Ç¢„Ç¶„Éà
                            </button>
                        </div>
                    </header>

                    <nav className="bg-white shadow-sm">
                        <div className="flex items-center justify-between px-4 py-3">
                            <div className="flex space-x-2">
                                <button
                                    onClick={() => setView('home')}
                                    className={`px-3 py-2 rounded-lg text-sm ${view === 'home' ? 'bg-purple-100 text-purple-700' : 'text-gray-600'}`}
                                >
                                    üè† „Éõ„Éº„É†
                                </button>
                                <button
                                    onClick={() => setView('mypage')}
                                    className={`px-3 py-2 rounded-lg text-sm ${view === 'mypage' ? 'bg-purple-100 text-purple-700' : 'text-gray-600'}`}
                                >
                                    üë§ „Éû„Ç§„Éö„Éº„Ç∏
                                </button>
                                <button
                                    onClick={() => setView('settings')}
                                    className={`px-3 py-2 rounded-lg text-sm ${view === 'settings' ? 'bg-purple-100 text-purple-700' : 'text-gray-600'}`}
                                >
                                    ‚öôÔ∏è Ë®≠ÂÆö
                                </button>
                            </div>
                            <button
                                onClick={() => setShowQR(true)}
                                className="bg-purple-600 text-white px-3 py-2 rounded-lg text-sm"
                            >
                                üì± „Åæ„ÅÑQR
                            </button>
                        </div>
                    </nav>

                    {showQR && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onClick={() => setShowQR(false)}>
                            <div className="bg-white rounded-lg p-6 max-w-sm w-full" onClick={(e) => e.stopPropagation()}>
                                <div className="flex justify-between mb-4">
                                    <h2 className="text-xl font-bold">„Éû„Ç§QR„Ç≥„Éº„Éâ</h2>
                                    <button onClick={() => setShowQR(false)} className="text-2xl">√ó</button>
                                </div>
                                <div className="flex flex-col items-center">
                                    <img src={`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(currentUser.qrCode)}`} alt="QR" className="mb-4" />
                                    <p className="text-sm text-gray-600 mb-2">‰∫§ÊµÅ‰ºöID</p>
                                    <p className="font-mono text-xs bg-gray-100 px-3 py-2 rounded break-all">{currentUser.qrCode}</p>
                                </div>
                            </div>
                        </div>
                    )}

                    {showRegistrationConfirm && selectedEvent && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onClick={() => setShowRegistrationConfirm(false)}>
                            <div className="bg-white rounded-lg p-6 max-w-sm w-full" onClick={(e) => e.stopPropagation()}>
                                <h2 className="text-xl font-bold mb-4">{selectedEvent.title}</h2>
                                <p className="text-gray-700 mb-6">ÂÜÜÊªë„Å™ÈÅãÂñ∂„ÅÆ„Åü„ÇÅ„ÅîÂçîÂäõ„Åè„Å†„Åï„ÅÑ„ÄÇÂÖ¨Èñã„ÅØ„Åó„Åæ„Åõ„Çì„ÄÇ</p>
                                <div className="flex gap-2">
                                    <button
                                        onClick={registerForEvent}
                                        className="flex-1 bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700"
                                    >
                                        ÂèÇÂä†„Çí‰∫àÂÆö„Åô„Çã
                                    </button>
                                    <button
                                        onClick={() => {
                                            setShowRegistrationConfirm(false);
                                            setSelectedEvent(null);
                                        }}
                                        className="flex-1 bg-gray-400 text-white py-3 rounded-lg hover:bg-gray-500"
                                    >
                                        „Ç≠„É£„É≥„Çª„É´
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showCancelConfirm && eventToCancel && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onClick={() => setShowCancelConfirm(false)}>
                            <div className="bg-white rounded-lg p-6 max-w-sm w-full" onClick={(e) => e.stopPropagation()}>
                                <h2 className="text-xl font-bold mb-4">ÂèÇÂä†„Ç≠„É£„É≥„Çª„É´</h2>
                                <p className="text-gray-700 mb-6">„Ç≠„É£„É≥„Çª„É´Êñô„ÅØ„ÅÑ„Åü„Å†„Åç„Åæ„Åõ„Çì</p>
                                <div className="flex gap-2">
                                    <button
                                        onClick={cancelEventRegistration}
                                        className="flex-1 bg-red-600 text-white py-3 rounded-lg hover:bg-red-700"
                                    >
                                        ÂèÇÂä†„Çí„Ç≠„É£„É≥„Çª„É´„Åô„Çã
                                    </button>
                                    <button
                                        onClick={() => {
                                            setShowCancelConfirm(false);
                                            setEventToCancel(null);
                                        }}
                                        className="flex-1 bg-gray-400 text-white py-3 rounded-lg hover:bg-gray-500"
                                    >
                                        Êàª„Çã
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {viewingAttendees && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto" onClick={() => setViewingAttendees(null)}>
                            <div className="bg-white rounded-lg p-6 max-w-2xl w-full my-8" onClick={(e) => e.stopPropagation()}>
                                <div className="flex justify-between mb-4">
                                    <h2 className="text-xl font-bold">{viewingAttendees.title} - Âá∫Â∏≠ËÄÖ‰∏ÄË¶ß</h2>
                                    <button onClick={() => setViewingAttendees(null)} className="text-2xl">√ó</button>
                                </div>
                                
                                <div className="mb-4 flex gap-2">
                                    <button
                                        onClick={() => {
                                            const publicAttendees = users.filter(u => 
                                                viewingAttendees.attendances.includes(u.id) && 
                                                u.profile.privacySetting === 'public' &&
                                                u.id !== currentUser.id
                                            );
                                            if (selectedAttendees.length === publicAttendees.length) {
                                                setSelectedAttendees([]);
                                            } else {
                                                setSelectedAttendees(publicAttendees.map(u => u.id));
                                            }
                                        }}
                                        className="bg-gray-200 px-4 py-2 rounded-lg hover:bg-gray-300 text-sm"
                                    >
                                        ÂÖ®Âì°ÈÅ∏Êäû
                                    </button>
                                    <button
                                        onClick={() => {
                                            const currentUserData = storage.get('currentUser');
                                            const existingContacts = currentUserData.contacts || [];
                                            const existingIds = existingContacts.map(c => c.userId);
                                            const newContacts = selectedAttendees
                                                .filter(id => !existingIds.includes(id))
                                                .map(userId => ({
                                                    userId,
                                                    eventId: viewingAttendees.id,
                                                    date: viewingAttendees.date
                                                }));
                                            if (newContacts.length === 0) {
                                                alert('Êñ∞„Åó„Åè‰øùÂ≠ò„Åô„ÇãÂèÇÂä†ËÄÖ„Åå„ÅÑ„Åæ„Åõ„Çì');
                                                return;
                                            }
                                            const updatedUser = {
                                                ...currentUserData,
                                                contacts: [...existingContacts, ...newContacts]
                                            };
                                            storage.set('currentUser', updatedUser);
                                            const allUsers = storage.get('users') || [];
                                            const updatedUsers = allUsers.map(u => u.id === currentUser.id ? updatedUser : u);
                                            storage.set('users', updatedUsers);
                                            alert(`${newContacts.length}Âêç„ÇíÂêçÁ∞ø„Å´‰øùÂ≠ò„Åó„Åæ„Åó„Åü`);
                                            setSelectedAttendees([]);
                                            setViewingAttendees(null);
                                            window.location.reload();
                                        }}
                                        className="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 text-sm"
                                    >
                                        ÂêçÁ∞ø„Å´‰øùÂ≠ò ({selectedAttendees.length})
                                    </button>
                                </div>

                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-3 max-h-96 overflow-y-auto">
                                    {users.filter(u => viewingAttendees.attendances.includes(u.id)).map(attendee => {
                                        const isPublic = attendee.profile.privacySetting === 'public';
                                        const isOwn = attendee.id === currentUser.id;
                                        return (
                                            <div key={attendee.id} className={`border rounded-lg p-3 ${!isPublic ? 'bg-gray-100' : ''}`}>
                                                <div className="flex items-start gap-3">
                                                    {!isOwn && isPublic && (
                                                        <input
                                                            type="checkbox"
                                                            checked={selectedAttendees.includes(attendee.id)}
                                                            onChange={() => {
                                                                if (selectedAttendees.includes(attendee.id)) {
                                                                    setSelectedAttendees(selectedAttendees.filter(id => id !== attendee.id));
                                                                } else {
                                                                    setSelectedAttendees([...selectedAttendees, attendee.id]);
                                                                }
                                                            }}
                                                            className="mt-1"
                                                        />
                                                    )}
                                                    <div className="flex-1 cursor-pointer" onClick={() => isPublic && setSelectedProfile(attendee)}>
                                                        {attendee.profile.photo && (
                                                            <img src={attendee.profile.photo} alt="" className="w-12 h-12 rounded-full object-cover mb-2" />
                                                        )}
                                                        <p className="font-bold text-sm">
                                                            {attendee.profile.fullName || attendee.profile.nickname || attendee.email}
                                                        </p>
                                                        {attendee.profile.fullName && attendee.profile.nickname && (
                                                            <p className="text-xs text-gray-600">Ôºà{attendee.profile.nickname}Ôºâ</p>
                                                        )}
                                                        {isOwn && <span className="text-xs text-gray-500">(„ÅÇ„Å™„Åü)</span>}
                                                        {!isPublic && !isOwn && <p className="text-xs text-gray-500 mt-1">üîí ÈùûÂÖ¨Èñã</p>}
                                                        {isPublic && !isOwn && <p className="text-xs text-purple-600 mt-1">„Çø„ÉÉ„Éó„ÅßË©≥Á¥∞</p>}
                                                    </div>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        </div>
                    )}

                    {selectedProfile && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4 overflow-y-auto" onClick={() => setSelectedProfile(null)}>
                            <div className="bg-white rounded-lg p-6 max-w-md w-full my-8" onClick={(e) => e.stopPropagation()}>
                                <div className="flex justify-between mb-4">
                                    <h2 className="text-xl font-bold">„Éó„É≠„Éï„Ç£„Éº„É´</h2>
                                    <button onClick={() => setSelectedProfile(null)} className="text-2xl">√ó</button>
                                </div>
                                <div className="space-y-3">
                                    {selectedProfile.profile.photo && (
                                        <img src={selectedProfile.profile.photo} alt="" className="w-24 h-24 rounded-full object-cover mx-auto" />
                                    )}
                                    {(selectedProfile.profile.fullName || selectedProfile.profile.nickname) && (
                                        <div>
                                            <label className="text-sm font-medium text-gray-600">ÂêçÂâç</label>
                                            <p className="font-bold">{selectedProfile.profile.fullName || selectedProfile.profile.nickname}</p>
                                            {selectedProfile.profile.fullName && selectedProfile.profile.nickname && (
                                                <p className="text-sm text-gray-600">Ôºà{selectedProfile.profile.nickname}Ôºâ</p>
                                            )}
                                        </div>
                                    )}
                                    {selectedProfile.profile.company && (
                                        <div><label className="text-sm font-medium text-gray-600">‰ºöÁ§æ„ÉªÂõ£‰Ωì</label><p>{selectedProfile.profile.company}</p></div>
                                    )}
                                    {selectedProfile.profile.email && (
                                        <div><label className="text-sm font-medium text-gray-600">„É°„Éº„É´</label><p>{selectedProfile.profile.email}</p></div>
                                    )}
                                    {selectedProfile.profile.phoneNumber && (
                                        <div><label className="text-sm font-medium text-gray-600">ÈõªË©±</label><p>{selectedProfile.profile.phoneNumber}</p></div>
                                    )}
                                    {(selectedProfile.profile.lineAccount || selectedProfile.profile.instagram || selectedProfile.profile.threads || selectedProfile.profile.facebook || selectedProfile.profile.twitter || selectedProfile.profile.linkedin) && (
                                        <div>
                                            <label className="text-sm font-medium text-gray-600">SNS</label>
                                            <div className="text-sm space-y-1">
                                                {selectedProfile.profile.lineAccount && <p>LINE: {selectedProfile.profile.lineAccount}</p>}
                                                {selectedProfile.profile.instagram && <p>Instagram: {selectedProfile.profile.instagram}</p>}
                                                {selectedProfile.profile.threads && <p>Threads: {selectedProfile.profile.threads}</p>}
                                                {selectedProfile.profile.facebook && <p>Facebook: {selectedProfile.profile.facebook}</p>}
                                                {selectedProfile.profile.twitter && <p>X: {selectedProfile.profile.twitter}</p>}
                                                {selectedProfile.profile.linkedin && <p>LinkedIn: {selectedProfile.profile.linkedin}</p>}
                                            </div>
                                        </div>
                                    )}
                                    {(selectedProfile.profile.businessCardFront || selectedProfile.profile.businessCardBack) && (
                                        <div>
                                            <label className="text-sm font-medium text-gray-600">ÂêçÂà∫</label>
                                            <div className="grid grid-cols-2 gap-2 mt-2">
                                                {selectedProfile.profile.businessCardFront && <img src={selectedProfile.profile.businessCardFront} alt="ÂêçÂà∫Ë°®" className="w-full rounded" />}
                                                {selectedProfile.profile.businessCardBack && <img src={selectedProfile.profile.businessCardBack} alt="ÂêçÂà∫Ë£è" className="w-full rounded" />}
                                            </div>
                                        </div>
                                    )}
                                    {selectedProfile.profile.introduction && (
                                        <div><label className="text-sm font-medium text-gray-600">Ëá™Â∑±Á¥π‰ªã</label><p className="whitespace-pre-wrap">{selectedProfile.profile.introduction}</p></div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    <main className="p-4">
                        {view === 'home' && (
                            <div>
                                <h2 className="text-xl font-bold mb-4">ÈñãÂÇ¨‰∫àÂÆö„ÅÆ„Ç§„Éô„É≥„Éà</h2>
                                {upcomingEvents.length === 0 ? (
                                    <div className="bg-white rounded-lg shadow p-6">
                                        <p className="text-gray-600 text-center">ÁèæÂú®„ÄÅÈñãÂÇ¨‰∫àÂÆö„ÅÆ„Ç§„Éô„É≥„Éà„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</p>
                                    </div>
                                ) : (
                                    <div className="space-y-3">
                                        {upcomingEvents.map(event => (
                                            <div
                                                key={event.id}
                                                className="bg-white rounded-lg shadow p-4"
                                            >
                                                <h3 className="font-bold text-lg mb-2">{event.title}</h3>
                                                <div className="text-sm text-gray-600 space-y-1 mb-3">
                                                    <p>üìÖ {formatDateTime(event.date)}</p>
                                                    {event.venueName && <p>üè¢ {event.venueName}</p>}
                                                    {event.address && <p>üìç {event.address}</p>}
                                                    {event.fee && <p>üí∞ {event.fee}</p>}
                                                </div>
                                                {isRegistered(event.id) ? (
                                                    <div className="bg-blue-50 border border-blue-200 rounded-lg p-3 text-center">
                                                        <p className="text-blue-800 font-medium text-sm">ÂèÇÂä†‰∫àÂÆö„Åß„Åô</p>
                                                    </div>
                                                ) : (
                                                    <button
                                                        onClick={() => {
                                                            setSelectedEvent(event);
                                                            setShowRegistrationConfirm(true);
                                                        }}
                                                        className="w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700"
                                                    >
                                                        ÂèÇÂä†„Çí‰∫àÂÆö„Åô„Çã
                                                    </button>
                                                )}
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>
                        )}

                        {view === 'mypage' && (
                            <div>
                                <div className="bg-white rounded-lg mb-4 overflow-x-auto">
                                    <div className="flex p-2 space-x-2 min-w-max">
                                        <button onClick={() => setMyPageView('overview')} className={`px-4 py-2 rounded-lg text-sm ${myPageView === 'overview' ? 'bg-purple-600 text-white' : 'bg-gray-100'}`}>Ê¶ÇË¶Å</button>
                                        <button onClick={() => setMyPageView('profile')} className={`px-4 py-2 rounded-lg text-sm ${myPageView === 'profile' ? 'bg-purple-600 text-white' : 'bg-gray-100'}`}>„Éó„É≠„Éï„Ç£„Éº„É´Á∑®ÈõÜ</button>
                                        <button onClick={() => setMyPageView('contacts')} className={`px-4 py-2 rounded-lg text-sm ${myPageView === 'contacts' ? 'bg-purple-600 text-white' : 'bg-gray-100'}`}>ÂêçÁ∞ø</button>
                                        <button onClick={() => setMyPageView('qr')} className={`px-4 py-2 rounded-lg text-sm ${myPageView === 'qr' ? 'bg-purple-600 text-white' : 'bg-gray-100'}`}>QR„Ç≥„Éº„Éâ</button>
                                    </div>
                                </div>

                                {myPageView === 'overview' && (
                                    <div className="space-y-6">
                                        <div className="bg-white rounded-lg shadow p-6">
                                            <h2 className="text-xl font-bold mb-4">ÂèÇÂä†‰∫àÂÆö„ÅÆ„Ç§„Éô„É≥„Éà</h2>
                                            {myRegisteredEvents.length === 0 ? (
                                                <p className="text-gray-600">ÂèÇÂä†‰∫àÂÆö„ÅÆ„Ç§„Éô„É≥„Éà„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</p>
                                            ) : (
                                                <div className="space-y-3">
                                                    {myRegisteredEvents.map(event => (
                                                        <div key={event.id} className="border rounded-lg p-4">
                                                            <h3 className="font-bold text-lg mb-2">{event.title}</h3>
                                                            <div className="text-sm text-gray-600 space-y-1 mb-3">
                                                                <p>üìÖ {formatDateTime(event.date)}</p>
                                                                {event.venueName && <p>üè¢ {event.venueName}</p>}
                                                                {event.address && <p>üìç {event.address}</p>}
                                                                {event.fee && <p>üí∞ {event.fee}</p>}
                                                            </div>
                                                            <button
                                                                onClick={() => {
                                                                    setEventToCancel(event);
                                                                    setShowCancelConfirm(true);
                                                                }}
                                                                className="w-full bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 text-sm"
                                                            >
                                                                ÂèÇÂä†„Çí„Ç≠„É£„É≥„Çª„É´
                                                            </button>
                                                        </div>
                                                    ))}
                                                </div>
                                            )}
                                        </div>

                                        {myOngoingEvents.length > 0 && (
                                            <div className="bg-white rounded-lg shadow p-6">
                                                <h2 className="text-xl font-bold mb-4">ÂèÇÂä†‰∏≠„ÅÆ„Ç§„Éô„É≥„Éà</h2>
                                                <div className="space-y-3">
                                                    {myOngoingEvents.map(event => {
                                                        const attendees = users.filter(u => event.attendances && event.attendances.includes(u.id));
                                                        const isExpanded = expandedEventId === event.id;
                                                        return (
                                                            <div key={event.id} className="border rounded-lg p-4 bg-blue-50">
                                                                <div className="flex items-start justify-between mb-2">
                                                                    <h3 className="font-bold text-lg">{event.title}</h3>
                                                                    <span className="bg-blue-600 text-white px-2 py-1 rounded text-xs">
                                                                        ÈñãÂÇ¨‰∏≠
                                                                    </span>
                                                                </div>
                                                                <div className="text-sm text-gray-600 space-y-1 mb-3">
                                                                    <p>üìÖ {formatDateTime(event.date)}</p>
                                                                    {event.venueName && <p>üè¢ {event.venueName}</p>}
                                                                    {event.address && <p>üìç {event.address}</p>}
                                                                </div>
                                                                
                                                                <button
                                                                    onClick={() => setExpandedEventId(isExpanded ? null : event.id)}
                                                                    className="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 text-sm mb-2"
                                                                >
                                                                    {isExpanded ? '‚ñº ÂèÇÂä†ËÄÖ„ÇíÈö†„Åô' : '‚ñ∂ ÂèÇÂä†ËÄÖ‰∏ÄË¶ß„ÇíË¶ã„Çã'}
                                                                </button>

                                                                {isExpanded && (
                                                                    <div className="mt-3 border-t pt-3">
                                                                        <div className="flex gap-2 mb-3">
                                                                            <button
                                                                                onClick={() => {
                                                                                    const publicAttendees = attendees.filter(u => 
                                                                                        u.profile.privacySetting === 'public' && u.id !== currentUser.id
                                                                                    );
                                                                                    if (selectedAttendees.length === publicAttendees.length) {
                                                                                        setSelectedAttendees([]);
                                                                                    } else {
                                                                                        setSelectedAttendees(publicAttendees.map(u => u.id));
                                                                                    }
                                                                                }}
                                                                                className="bg-gray-200 px-3 py-1 rounded text-sm hover:bg-gray-300"
                                                                            >
                                                                                ÂÖ®Âì°ÈÅ∏Êäû
                                                                            </button>
                                                                            <button
                                                                                onClick={() => {
                                                                                    if (selectedAttendees.length === 0) {
                                                                                        alert('‰øùÂ≠ò„Åô„ÇãÂèÇÂä†ËÄÖ„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                                                                                        return;
                                                                                    }
                                                                                    const currentUserData = storage.get('currentUser');
                                                                                    const existingContacts = currentUserData.contacts || [];
                                                                                    const existingIds = existingContacts.map(c => c.userId);
                                                                                    const newContacts = selectedAttendees
                                                                                        .filter(id => !existingIds.includes(id))
                                                                                        .map(userId => ({ userId, eventId: event.id, date: event.date }));
                                                                                    if (newContacts.length === 0) {
                                                                                        alert('Êñ∞„Åó„Åè‰øùÂ≠ò„Åô„ÇãÂèÇÂä†ËÄÖ„Åå„ÅÑ„Åæ„Åõ„Çì');
                                                                                        return;
                                                                                    }
                                                                                    const updatedUser = { ...currentUserData, contacts: [...existingContacts, ...newContacts] };
                                                                                    storage.set('currentUser', updatedUser);
                                                                                    const allUsers = storage.get('users') || [];
                                                                                    storage.set('users', allUsers.map(u => u.id === currentUser.id ? updatedUser : u));
                                                                                    alert(`${newContacts.length}Âêç„ÇíÂêçÁ∞ø„Å´‰øùÂ≠ò„Åó„Åæ„Åó„Åü`);
                                                                                    setSelectedAttendees([]);
                                                                                    window.location.reload();
                                                                                }}
                                                                                className="bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700"
                                                                            >
                                                                                ÂêçÁ∞ø„Å´‰øùÂ≠ò ({selectedAttendees.length})
                                                                            </button>
                                                                        </div>

                                                                        <div className="space-y-2">
                                                                            {attendees.map(attendee => {
                                                                                const isPublic = attendee.profile.privacySetting === 'public';
                                                                                const isOwn = attendee.id === currentUser.id;
                                                                                return (
                                                                                    <div key={attendee.id} className={`flex items-center gap-3 p-2 rounded ${!isPublic ? 'bg-gray-100' : 'hover:bg-gray-50'}`}>
                                                                                        {!isOwn && isPublic && (
                                                                                            <input
                                                                                                type="checkbox"
                                                                                                checked={selectedAttendees.includes(attendee.id)}
                                                                                                onChange={() => {
                                                                                                    if (selectedAttendees.includes(attendee.id)) {
                                                                                                        setSelectedAttendees(selectedAttendees.filter(id => id !== attendee.id));
                                                                                                    } else {
                                                                                                        setSelectedAttendees([...selectedAttendees, attendee.id]);
                                                                                                    }
                                                                                                }}
                                                                                            />
                                                                                        )}
                                                                                        <div 
                                                                                            className="flex items-center gap-2 flex-1 cursor-pointer"
                                                                                            onClick={() => isPublic && setSelectedProfile(attendee)}
                                                                                        >
                                                                                            {attendee.profile.photo && (
                                                                                                <img src={attendee.profile.photo} alt="" className="w-10 h-10 rounded-full object-cover" />
                                                                                            )}
                                                                                            <div className="flex-1">
                                                                                                <p className="font-medium text-sm">
                                                                                                    {attendee.profile.fullName || attendee.profile.nickname || attendee.email}
                                                                                                </p>
                                                                                                {attendee.profile.fullName && attendee.profile.nickname && (
                                                                                                    <p className="text-xs text-gray-500">Ôºà{attendee.profile.nickname}Ôºâ</p>
                                                                                                )}
                                                                                                {isOwn && <span className="text-xs text-gray-500">(„ÅÇ„Å™„Åü)</span>}
                                                                                            </div>
                                                                                            {!isPublic && !isOwn && <span className="text-xs text-gray-500">üîí</span>}
                                                                                        </div>
                                                                                    </div>
                                                                                );
                                                                            })}
                                                                        </div>
                                                                    </div>
                                                                )}
                                                            </div>
                                                        );
                                                    })}
                                                </div>
                                            </div>
                                        )}

                                        <div className="bg-white rounded-lg shadow p-6">
                                            <h2 className="text-xl font-bold mb-4">ÂèÇÂä†Ê∏à„Åø„ÅÆ„Ç§„Éô„É≥„ÉàÔºàÁµåÊ≠¥Ôºâ</h2>
                                            {myAttendedEvents.length === 0 ? (
                                                <p className="text-gray-600">ÂèÇÂä†Ê∏à„Åø„ÅÆ„Ç§„Éô„É≥„Éà„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</p>
                                            ) : (
                                                <div className="space-y-3">
                                                    {myAttendedEvents.map(event => (
                                                        <div key={event.id} className="border rounded-lg p-4 bg-gray-50">
                                                            <div className="flex items-start justify-between mb-2">
                                                                <h3 className="font-bold text-lg">{event.title}</h3>
                                                                <span className="bg-green-100 text-green-800 px-2 py-1 rounded text-xs">
                                                                    Âá∫Â∏≠Ê∏à„Åø
                                                                </span>
                                                            </div>
                                                            <div className="text-sm text-gray-600 space-y-1 mb-3">
                                                                <p>üìÖ {formatDateTime(event.date)}</p>
                                                                {event.venueName && <p>üè¢ {event.venueName}</p>}
                                                                {event.address && <p>üìç {event.address}</p>}
                                                            </div>
                                                            <button
                                                                onClick={() => setViewingAttendees(event)}
                                                                className="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 text-sm"
                                                            >
                                                                üë• Âá∫Â∏≠ËÄÖ‰∏ÄË¶ß„ÇíË¶ã„Çã
                                                            </button>
                                                        </div>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                    </div>
                                )}

                                {myPageView === 'profile' && (
                                    <div>
                                        <div className="bg-white rounded-lg shadow p-6 mb-4">
                                            <div className="flex justify-between items-start mb-4">
                                                <div className="flex-1">
                                                    <h2 className="text-xl font-bold mb-3">„Éó„É≠„Éï„Ç£„Éº„É´„Éó„É¨„Éì„É•„Éº</h2>
                                                    <div className="bg-blue-50 border border-blue-200 rounded-lg p-3">
                                                        <label className="block text-sm font-medium mb-2">„Éó„É©„Ç§„Éê„Ç∑„ÉºË®≠ÂÆö</label>
                                                        <div className="space-y-2">
                                                            <label className="flex items-center text-sm cursor-pointer">
                                                                <input 
                                                                    type="radio" 
                                                                    name="privacySettingPreview" 
                                                                    value="public" 
                                                                    checked={profileData.privacySetting === 'public'} 
                                                                    onChange={(e) => {
                                                                        const newData = {...profileData, privacySetting: e.target.value};
                                                                        setProfileData(newData);
                                                                        onUpdateProfile(newData);
                                                                    }}
                                                                    className="mr-2" 
                                                                />
                                                                <span>üåê „Ç§„Éô„É≥„ÉàÂèÇÂä†ËÄÖÂÖ®Âì°„Å´ÂÖ¨Èñã</span>
                                                            </label>
                                                            <label className="flex items-center text-sm cursor-pointer">
                                                                <input 
                                                                    type="radio" 
                                                                    name="privacySettingPreview" 
                                                                    value="qr-only" 
                                                                    checked={profileData.privacySetting === 'qr-only'} 
                                                                    onChange={(e) => {
                                                                        const newData = {...profileData, privacySetting: e.target.value};
                                                                        setProfileData(newData);
                                                                        onUpdateProfile(newData);
                                                                    }}
                                                                    className="mr-2" 
                                                                />
                                                                <span>üîí QR‰∫§Êèõ„Åó„Åü‰∫∫„Å®„ÅÆ„ÅøÂÖ¨Èñã</span>
                                                            </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                <button
                                                    onClick={() => setIsEditingProfile(!isEditingProfile)}
                                                    className="ml-4 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 text-sm whitespace-nowrap"
                                                >
                                                    {isEditingProfile ? 'Á∑®ÈõÜ„ÇíÈñâ„Åò„Çã' : '‚úèÔ∏è Á∑®ÈõÜ'}
                                                </button>
                                            </div>
                                            <div className="space-y-3">
                                                {(profileData.nickname || profileData.fullName) && (
                                                    <div>
                                                        <label className="text-sm font-medium text-gray-600">ÂêçÂâç</label>
                                                        <p className="text-base font-bold">{profileData.fullName || profileData.nickname}</p>
                                                        {profileData.fullName && profileData.nickname && (
                                                            <p className="text-sm text-gray-600">Ôºà{profileData.nickname}Ôºâ</p>
                                                        )}
                                                    </div>
                                                )}
                                                
                                                {profileData.photo && (
                                                    <div>
                                                        <img src={profileData.photo} alt="„Éó„É≠„Éï„Ç£„Éº„É´ÂÜôÁúü" className="w-24 h-24 rounded-full object-cover" />
                                                    </div>
                                                )}
                                                
                                                {profileData.company && (
                                                    <div>
                                                        <label className="text-sm font-medium text-gray-600">‰ºöÁ§æ„ÉªÂõ£‰Ωì</label>
                                                        <p className="text-base">{profileData.company}</p>
                                                    </div>
                                                )}
                                                
                                                {profileData.email && (
                                                    <div>
                                                        <label className="text-sm font-medium text-gray-600">„É°„Éº„É´</label>
                                                        <p className="text-base">{profileData.email}</p>
                                                    </div>
                                                )}
                                                
                                                {profileData.phoneNumber && (
                                                    <div>
                                                        <label className="text-sm font-medium text-gray-600">ÈõªË©±</label>
                                                        <p className="text-base">{profileData.phoneNumber}</p>
                                                    </div>
                                                )}
                                                
                                                {(profileData.lineAccount || profileData.instagram || profileData.threads || profileData.facebook || profileData.twitter || profileData.linkedin) && (
                                                    <div>
                                                        <label className="text-sm font-medium text-gray-600">SNS</label>
                                                        <div className="space-y-1">
                                                            {profileData.lineAccount && <p className="text-sm">LINE: {profileData.lineAccount}</p>}
                                                            {profileData.instagram && <p className="text-sm">Instagram: {profileData.instagram}</p>}
                                                            {profileData.threads && <p className="text-sm">Threads: {profileData.threads}</p>}
                                                            {profileData.facebook && <p className="text-sm">Facebook: {profileData.facebook}</p>}
                                                            {profileData.twitter && <p className="text-sm">X: {profileData.twitter}</p>}
                                                            {profileData.linkedin && <p className="text-sm">LinkedIn: {profileData.linkedin}</p>}
                                                        </div>
                                                    </div>
                                                )}
                                                
                                                {(profileData.businessCardFront || profileData.businessCardBack) && (
                                                    <div>
                                                        <label className="text-sm font-medium text-gray-600">ÂêçÂà∫</label>
                                                        <div className="grid grid-cols-2 gap-2 mt-2">
                                                            {profileData.businessCardFront && <img src={profileData.businessCardFront} alt="ÂêçÂà∫Ë°®" className="w-full rounded" />}
                                                            {profileData.businessCardBack && <img src={profileData.businessCardBack} alt="ÂêçÂà∫Ë£è" className="w-full rounded" />}
                                                        </div>
                                                    </div>
                                                )}
                                                
                                                {profileData.introduction && (
                                                    <div>
                                                        <label className="text-sm font-medium text-gray-600">Ëá™Â∑±Á¥π‰ªã</label>
                                                        <p className="text-base whitespace-pre-wrap">{profileData.introduction}</p>
                                                    </div>
                                                )}
                                            </div>
                                        </div>

                                        {isEditingProfile && (
                                        <div className="bg-white rounded-lg shadow p-6">
                                            <h2 className="text-xl font-bold mb-4">„Éó„É≠„Éï„Ç£„Éº„É´Á∑®ÈõÜ</h2>
                                        <form onSubmit={saveProfile} className="space-y-4">
                                            <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                                                <p className="text-xs text-yellow-800">‚Äª „Éã„ÉÉ„ÇØ„Éç„Éº„É†„Åæ„Åü„ÅØÊ∞èÂêç„ÅÆ„Å©„Å°„Çâ„Åã‰∏ÄÊñπ„ÅØÂøÖÈ†à„Åß„Åô</p>
                                            </div>

                                            <div className="grid grid-cols-2 gap-4">
                                                <div>
                                                    <label className="block text-sm font-medium mb-1">„Éã„ÉÉ„ÇØ„Éç„Éº„É†</label>
                                                    <input type="text" value={profileData.nickname} onChange={(e) => setProfileData({...profileData, nickname: e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" />
                                                </div>
                                                <div>
                                                    <label className="block text-sm font-medium mb-1">Ê∞èÂêç</label>
                                                    <input type="text" value={profileData.fullName} onChange={(e) => setProfileData({...profileData, fullName: e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" />
                                                </div>
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium mb-1">È°îÂÜôÁúüÔºà‰ªªÊÑèÔºâ</label>
                                                <input type="file" accept="image/*" onChange={(e) => handleImageUpload(e, 'photo')} className="w-full px-3 py-2 border rounded-lg text-sm" />
                                                {profileData.photo && <img src={profileData.photo} alt="È°îÂÜôÁúü" className="mt-2 w-20 h-20 rounded-full object-cover" />}
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium mb-1">„É°„Éº„É´„Ç¢„Éâ„É¨„ÇπÔºà‰ªªÊÑèÔºâ</label>
                                                <input type="email" value={profileData.email || ''} onChange={(e) => setProfileData({...profileData, email: e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" placeholder="ÂÖ¨ÈñãÁî®" />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium mb-1">ÈõªË©±Áï™Âè∑Ôºà‰ªªÊÑèÔºâ</label>
                                                <input type="tel" value={profileData.phoneNumber} onChange={(e) => setProfileData({...profileData, phoneNumber: e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium mb-1">‰ºöÁ§æ„ÉªÂõ£‰ΩìÂêçÔºà‰ªªÊÑèÔºâ</label>
                                                <input type="text" value={profileData.company} onChange={(e) => setProfileData({...profileData, company: e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" />
                                            </div>

                                            <div className="border-t pt-4">
                                                <h3 className="font-semibold mb-3 text-sm">SNS„Ç¢„Ç´„Ç¶„É≥„ÉàÔºà‰ªªÊÑèÔºâ</h3>
                                                <div className="space-y-3">
                                                    <div>
                                                        <label className="block text-xs font-medium mb-1">LINE</label>
                                                        <input type="text" value={profileData.lineAccount} onChange={(e) => setProfileData({...profileData, lineAccount: e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" />
                                                    </div>

                                                    <div>
                                                        <label className="block text-xs font-medium mb-1">Instagram</label>
                                                        <input type="text" value={profileData.instagram} onChange={(e) => setProfileData({...profileData, instagram: e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" placeholder="@username" />
                                                    </div>

                                                    <div>
                                                        <label className="block text-xs font-medium mb-1">Threads</label>
                                                        <input type="text" value={profileData.threads} onChange={(e) => setProfileData({...profileData, threads: e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" placeholder="@username" />
                                                    </div>

                                                    <div>
                                                        <label className="block text-xs font-medium mb-1">Facebook</label>
                                                        <input type="text" value={profileData.facebook} onChange={(e) => setProfileData({...profileData, facebook: e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" />
                                                    </div>

                                                    <div>
                                                        <label className="block text-xs font-medium mb-1">X (Twitter)</label>
                                                        <input type="text" value={profileData.twitter} onChange={(e) => setProfileData({...profileData, twitter: e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" placeholder="@username" />
                                                    </div>

                                                    <div>
                                                        <label className="block text-xs font-medium mb-1">LinkedIn</label>
                                                        <input type="text" value={profileData.linkedin} onChange={(e) => setProfileData({...profileData, linkedin: e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" />
                                                    </div>
                                                </div>
                                            </div>

                                            <div className="border-t pt-4">
                                                <h3 className="font-semibold mb-3 text-sm">ÂêçÂà∫Ôºà‰ªªÊÑèÔºâ</h3>
                                                <div className="grid grid-cols-2 gap-4">
                                                    <div>
                                                        <label className="block text-xs font-medium mb-1">Ë°®Èù¢</label>
                                                        <input type="file" accept="image/*" onChange={(e) => handleImageUpload(e, 'businessCardFront')} className="w-full px-2 py-2 border rounded-lg text-xs" />
                                                        {profileData.businessCardFront && <img src={profileData.businessCardFront} alt="ÂêçÂà∫Ë°®" className="mt-2 w-full rounded" />}
                                                    </div>
                                                    <div>
                                                        <label className="block text-xs font-medium mb-1">Ë£èÈù¢</label>
                                                        <input type="file" accept="image/*" onChange={(e) => handleImageUpload(e, 'businessCardBack')} className="w-full px-2 py-2 border rounded-lg text-xs" />
                                                        {profileData.businessCardBack && <img src={profileData.businessCardBack} alt="ÂêçÂà∫Ë£è" className="mt-2 w-full rounded" />}
                                                    </div>
                                                </div>
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium mb-1">ÁâπÊäÄ„ÉªËá™Â∑±Á¥π‰ªãÔºà‰ªªÊÑèÔºâ</label>
                                                <textarea value={profileData.introduction} onChange={(e) => setProfileData({...profileData, introduction: e.target.value})} className="w-full px-3 py-2 border rounded-lg text-sm" rows="4" />
                                            </div>

                                            <button type="submit" className="w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700">
                                                „Éó„É≠„Éï„Ç£„Éº„É´„Çí‰øùÂ≠ò
                                            </button>
                                        </form>
                                        </div>
                                        )}
                                    </div>
                                )}

                                {myPageView === 'contacts' && (
                                    <div className="bg-white rounded-lg shadow p-6">
                                        <h2 className="text-xl font-bold mb-4">ÂêçÁ∞ø</h2>
                                        <p>‰∫§ÊµÅ„Åó„Åü‰∫∫„ÅÆÂêçÁ∞ø„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô</p>
                                    </div>
                                )}

                                {myPageView === 'qr' && (
                                    <div className="bg-white rounded-lg shadow p-6">
                                        <h2 className="text-xl font-bold mb-4 text-center">„Éû„Ç§QR„Ç≥„Éº„Éâ</h2>
                                        <div className="flex flex-col items-center">
                                            <img src={`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(currentUser.qrCode)}`} alt="QR" className="mb-4" />
                                            <p className="text-sm text-gray-600">‰∫§ÊµÅ‰ºöID: {currentUser.qrCode}</p>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {view === 'settings' && (
                            <div className="bg-white rounded-lg shadow p-6">
                                <h2 className="text-xl font-bold mb-6">Ë®≠ÂÆö</h2>
                                <div>
                                    <h3 className="font-semibold mb-2">„Ç¢„Ç´„Ç¶„É≥„ÉàÊÉÖÂ†±</h3>
                                    <p className="text-sm text-gray-600">„É°„Éº„É´: {currentUser.email}</p>
                                </div>
                                {currentUser.isAdmin && (
                                    <button onClick={() => setShowAdmin(true)} className="mt-6 w-full bg-red-600 text-white py-3 rounded-lg hover:bg-red-700">
                                        üîß ÁÆ°ÁêÜËÄÖ„Éë„Éç„É´„ÇíÈñã„Åè
                                    </button>
                                )}
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        function AdminPanel({ users, onBack, onLogout }) {
            const [events, setEvents] = useState([]);
            const [showEventForm, setShowEventForm] = useState(false);
            const [editingEvent, setEditingEvent] = useState(null);
            const [eventForm, setEventForm] = useState({
                title: '',
                date: '',
                endDate: '',
                address: '',
                venueName: '',
                fee: ''
            });
            const [showQRScanner, setShowQRScanner] = useState(false);
            const [selectedEventForCheckIn, setSelectedEventForCheckIn] = useState(null);
            const [scannedQRCode, setScannedQRCode] = useState('');

            const formatDateTime = (dateString) => {
                const date = new Date(dateString);
                return date.toLocaleString('ja-JP', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            };

            useEffect(() => {
                const savedEvents = storage.get('events') || [];
                setEvents(savedEvents);
            }, []);

            const checkInUser = () => {
                if (!scannedQRCode || !selectedEventForCheckIn) {
                    alert('QR„Ç≥„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                    return;
                }

                const user = users.find(u => u.qrCode === scannedQRCode);
                if (!user) {
                    alert('ÁÑ°Âäπ„Å™QR„Ç≥„Éº„Éâ„Åß„Åô');
                    return;
                }

                const updatedEvents = events.map(event => {
                    if (event.id === selectedEventForCheckIn.id) {
                        const attendances = event.attendances || [];
                        if (attendances.includes(user.id)) {
                            alert('Êó¢„Å´Âèó‰ªòÊ∏à„Åø„Åß„Åô');
                            return event;
                        }
                        return { ...event, attendances: [...attendances, user.id] };
                    }
                    return event;
                });

                storage.set('events', updatedEvents);
                setEvents(updatedEvents);
                alert(`${user.profile.fullName || user.profile.nickname || user.email} „ÇíÂèó‰ªò„Åó„Åæ„Åó„Åü`);
                setScannedQRCode('');
            };

            const resetForm = () => {
                setEventForm({
                    title: '',
                    date: '',
                    endDate: '',
                    address: '',
                    venueName: '',
                    fee: ''
                });
                setEditingEvent(null);
            };

            const handleCreateEvent = () => {
                resetForm();
                setShowEventForm(true);
            };

            const handleEditEvent = (event) => {
                setEventForm({
                    title: event.title,
                    date: event.date,
                    endDate: event.endDate || '',
                    address: event.address || '',
                    venueName: event.venueName || '',
                    fee: event.fee || ''
                });
                setEditingEvent(event);
                setShowEventForm(true);
            };

            const handleSaveEvent = (e) => {
                e.preventDefault();
                
                if (!eventForm.title || !eventForm.date) {
                    alert('„Çø„Ç§„Éà„É´„Å®ÈñãÂÇ¨Êó•ÊôÇ„ÅØÂøÖÈ†à„Åß„Åô');
                    return;
                }

                let updatedEvents;
                
                if (editingEvent) {
                    // Edit existing event
                    updatedEvents = events.map(event => 
                        event.id === editingEvent.id 
                            ? { ...event, ...eventForm }
                            : event
                    );
                    alert('„Ç§„Éô„É≥„Éà„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü');
                } else {
                    // Create new event
                    const newEvent = {
                        id: Date.now().toString(),
                        ...eventForm,
                        registrations: [],
                        attendances: []
                    };
                    updatedEvents = [...events, newEvent];
                    alert('„Ç§„Éô„É≥„Éà„Çí‰ΩúÊàê„Åó„Åæ„Åó„Åü');
                }

                storage.set('events', updatedEvents);
                setEvents(updatedEvents);
                resetForm();
                setShowEventForm(false);
            };

            const handleDeleteEvent = (eventId) => {
                if (window.confirm('„Åì„ÅÆ„Ç§„Éô„É≥„Éà„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                    const updatedEvents = events.filter(e => e.id !== eventId);
                    storage.set('events', updatedEvents);
                    setEvents(updatedEvents);
                    alert('„Ç§„Éô„É≥„Éà„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü');
                }
            };

            return (
                <div className="min-h-screen bg-gray-50">
                    <header className="gradient-bg text-white p-4">
                        <div className="flex justify-between items-center">
                            <div className="flex items-center space-x-2">
                                <button onClick={onBack} className="bg-white text-purple-600 px-3 py-2 rounded-lg text-sm">‚Üê Êàª„Çã</button>
                                <h1 className="text-xl font-bold">ÁÆ°ÁêÜËÄÖ„Éë„Éç„É´</h1>
                            </div>
                            <button onClick={onLogout} className="bg-white text-purple-600 px-3 py-2 rounded-lg text-sm">„É≠„Ç∞„Ç¢„Ç¶„Éà</button>
                        </div>
                    </header>

                    <main className="p-4">
                        {showQRScanner && selectedEventForCheckIn && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4" onClick={() => setShowQRScanner(false)}>
                                <div className="bg-white rounded-lg p-6 max-w-sm w-full" onClick={(e) => e.stopPropagation()}>
                                    <div className="flex justify-between mb-4">
                                        <h2 className="text-xl font-bold">Âèó‰ªò</h2>
                                        <button onClick={() => setShowQRScanner(false)} className="text-2xl">√ó</button>
                                    </div>
                                    <p className="text-sm text-gray-700 mb-4">ÂèÇÂä†ËÄÖ„ÅÆQR„Ç≥„Éº„ÉâID„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                                    <input
                                        type="text"
                                        value={scannedQRCode}
                                        onChange={(e) => setScannedQRCode(e.target.value)}
                                        className="w-full px-3 py-2 border rounded-lg mb-4"
                                        placeholder="KOSASENBU-xxxxx"
                                    />
                                    <div className="flex gap-2">
                                        <button
                                            onClick={checkInUser}
                                            className="flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700"
                                        >
                                            Âèó‰ªò„Åô„Çã
                                        </button>
                                        <button
                                            onClick={() => {
                                                setShowQRScanner(false);
                                                setScannedQRCode('');
                                            }}
                                            className="flex-1 bg-gray-400 text-white py-3 rounded-lg hover:bg-gray-500"
                                        >
                                            „Ç≠„É£„É≥„Çª„É´
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        <div className="bg-white rounded-lg shadow p-6 mb-4">
                            <h2 className="text-xl font-bold mb-4">„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</h2>
                            <div className="space-y-2">
                                <p className="text-gray-700">Á∑è„É¶„Éº„Ç∂„ÉºÊï∞: {users.length}</p>
                                <p className="text-gray-700">Á∑è„Ç§„Éô„É≥„ÉàÊï∞: {events.length}</p>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow p-6 mb-4">
                            <div className="flex justify-between items-center mb-4">
                                <h2 className="text-xl font-bold">„Ç§„Éô„É≥„ÉàÁÆ°ÁêÜ</h2>
                                {!showEventForm && (
                                    <button
                                        onClick={handleCreateEvent}
                                        className="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 text-sm"
                                    >
                                        ‚ûï Êñ∞Ë¶è„Ç§„Éô„É≥„Éà‰ΩúÊàê
                                    </button>
                                )}
                            </div>

                            {showEventForm && (
                                <div className="mb-6 p-4 border-2 border-purple-200 rounded-lg bg-purple-50">
                                    <h3 className="text-lg font-bold mb-4">
                                        {editingEvent ? '„Ç§„Éô„É≥„ÉàÁ∑®ÈõÜ' : 'Êñ∞Ë¶è„Ç§„Éô„É≥„Éà‰ΩúÊàê'}
                                    </h3>
                                    <form onSubmit={handleSaveEvent} className="space-y-4">
                                        <div>
                                            <label className="block text-sm font-medium mb-1">
                                                „Ç§„Éô„É≥„Éà„Çø„Ç§„Éà„É´ <span className="text-red-600">*</span>
                                            </label>
                                            <input
                                                type="text"
                                                value={eventForm.title}
                                                onChange={(e) => setEventForm({...eventForm, title: e.target.value})}
                                                className="w-full px-3 py-2 border rounded-lg text-sm"
                                                placeholder="‰æãÔºö2ÊúàÂ∫¶ ‰∫§ÊµÅ‰ºö"
                                                required
                                            />
                                        </div>

                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <label className="block text-sm font-medium mb-1">
                                                    ÈñãÂÇ¨Êó•ÊôÇ <span className="text-red-600">*</span>
                                                </label>
                                                <input
                                                    type="datetime-local"
                                                    value={eventForm.date}
                                                    onChange={(e) => setEventForm({...eventForm, date: e.target.value})}
                                                    className="w-full px-3 py-2 border rounded-lg text-sm"
                                                    required
                                                />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium mb-1">ÁµÇ‰∫ÜÊó•ÊôÇ</label>
                                                <input
                                                    type="datetime-local"
                                                    value={eventForm.endDate}
                                                    onChange={(e) => setEventForm({...eventForm, endDate: e.target.value})}
                                                    className="w-full px-3 py-2 border rounded-lg text-sm"
                                                />
                                            </div>
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium mb-1">‰ΩèÊâÄ</label>
                                            <input
                                                type="text"
                                                value={eventForm.address}
                                                onChange={(e) => setEventForm({...eventForm, address: e.target.value})}
                                                className="w-full px-3 py-2 border rounded-lg text-sm"
                                                placeholder="‰æãÔºöÊù±‰∫¨ÈÉΩÊ∏ãË∞∑Âå∫Ê∏ãË∞∑1-1-1"
                                            />
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium mb-1">ÊñΩË®≠Âêç</label>
                                            <input
                                                type="text"
                                                value={eventForm.venueName}
                                                onChange={(e) => setEventForm({...eventForm, venueName: e.target.value})}
                                                className="w-full px-3 py-2 border rounded-lg text-sm"
                                                placeholder="‰æãÔºöÊ∏ãË∞∑„Ç´„É≥„Éï„Ç°„É¨„É≥„Çπ„É´„Éº„É†"
                                            />
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium mb-1">ÂèÇÂä†ÊñôÈáë</label>
                                            <input
                                                type="text"
                                                value={eventForm.fee}
                                                onChange={(e) => setEventForm({...eventForm, fee: e.target.value})}
                                                className="w-full px-3 py-2 border rounded-lg text-sm"
                                                placeholder="‰æãÔºö3,000ÂÜÜ"
                                            />
                                        </div>

                                        <div className="flex gap-2">
                                            <button
                                                type="submit"
                                                className="flex-1 bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700"
                                            >
                                                {editingEvent ? 'Êõ¥Êñ∞' : '‰ΩúÊàê'}
                                            </button>
                                            <button
                                                type="button"
                                                onClick={() => {
                                                    resetForm();
                                                    setShowEventForm(false);
                                                }}
                                                className="flex-1 bg-gray-400 text-white py-3 rounded-lg hover:bg-gray-500"
                                            >
                                                „Ç≠„É£„É≥„Çª„É´
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            )}

                            <div className="space-y-4">
                                <h3 className="font-semibold text-gray-700">Êó¢Â≠ò„Ç§„Éô„É≥„Éà‰∏ÄË¶ß</h3>
                                {events.length === 0 ? (
                                    <p className="text-gray-500 text-sm">„Åæ„Å†„Ç§„Éô„É≥„Éà„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p>
                                ) : (
                                    events.map(event => (
                                        <div key={event.id} className="border rounded-lg p-4 bg-gray-50">
                                            <div className="flex justify-between items-start mb-2">
                                                <h4 className="font-bold text-lg">{event.title}</h4>
                                                <div className="flex gap-2 flex-wrap">
                                                    <button
                                                        onClick={() => {
                                                            const attendances = event.attendances || [];
                                                            if (attendances.includes('admin-1')) {
                                                                alert('Êó¢„Å´Âá∫Â∏≠Ê∏à„Åø„Åß„Åô');
                                                                return;
                                                            }
                                                            const updatedEvents = events.map(e => 
                                                                e.id === event.id 
                                                                    ? { ...e, attendances: [...attendances, 'admin-1'] }
                                                                    : e
                                                            );
                                                            storage.set('events', updatedEvents);
                                                            setEvents(updatedEvents);
                                                            alert('Ëá™ÂàÜ„ÇíÂá∫Â∏≠ÁôªÈå≤„Åó„Åæ„Åó„Åü');
                                                        }}
                                                        className="bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700 whitespace-nowrap"
                                                    >
                                                        ‚úì Ëá™ÂàÜ„ÇÇÂá∫Â∏≠
                                                    </button>
                                                    <button
                                                        onClick={() => {
                                                            setSelectedEventForCheckIn(event);
                                                            setShowQRScanner(true);
                                                        }}
                                                        className="bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 whitespace-nowrap"
                                                    >
                                                        üì∑ Âèó‰ªò
                                                    </button>
                                                    <button
                                                        onClick={() => handleEditEvent(event)}
                                                        className="bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700"
                                                    >
                                                        ‚úèÔ∏è Á∑®ÈõÜ
                                                    </button>
                                                    <button
                                                        onClick={() => handleDeleteEvent(event.id)}
                                                        className="bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700"
                                                    >
                                                        üóëÔ∏è ÂâäÈô§
                                                    </button>
                                                </div>
                                            </div>
                                            <div className="text-sm text-gray-600 space-y-1">
                                                <p>üìÖ ÈñãÂÇ¨: {formatDateTime(event.date)}</p>
                                                {event.endDate && <p>üìÖ ÁµÇ‰∫Ü: {formatDateTime(event.endDate)}</p>}
                                                {event.venueName && <p>üè¢ {event.venueName}</p>}
                                                {event.address && <p>üìç {event.address}</p>}
                                                {event.fee && <p>üí∞ {event.fee}</p>}
                                                <p className="text-gray-500">ÂèÇÂä†Â∏åÊúõ: {event.registrations?.length || 0}Âêç / Âá∫Â∏≠: {event.attendances?.length || 0}Âêç</p>
                                            </div>
                                        </div>
                                    ))
                                )}
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow p-6">
                            <h2 className="text-xl font-bold mb-4">„É¶„Éº„Ç∂„Éº‰∏ÄË¶ß</h2>
                            <div className="space-y-2">
                                {users.map(user => (
                                    <div key={user.id} className="flex justify-between items-center p-3 border rounded">
                                        <span className="text-sm">{user.email}</span>
                                        {user.isAdmin && <span className="bg-red-100 text-red-800 px-2 py-1 rounded text-xs">ÁÆ°ÁêÜËÄÖ</span>}
                                    </div>
                                ))}
                            </div>
                        </div>
                    </main>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
